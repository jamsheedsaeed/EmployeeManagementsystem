
<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>view employee</title>

<link href="/stylesheet/view.css" rel="stylesheet">
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.3/angular-route.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<!--<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">-->
<!--<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>-->

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="script.js"></script>

</head>
<body>
  
<div>
  
  
<div>
   
  <div  ><img src="images/ems1.png"  height="100px" width="200px" margin=0px> </div>
   
    <nav class="topnav" id="myTopnav"  role="navigation"  style="padding-left:130px;background-color:rgb(105, 25, 125)">
       <ul class="nav navbar-nav">
      <li class="active"><a href="/secret">Home<span class="sr-only">(current)</span></a></li>
     <li><a href="/about">About<span ></span></a></li>
      <li><a href="/register">Register</a></li>
      <li><a href="">Update Employee</a></li>
      <li><a href="/viewemp">view</a></li>
      <li><a href="/event">View Events</a></li>
      <li><a href="/events">Events</a></li>
      <li><a href="">Leaves details</a></li>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/"><span class="glyphicon glyphicon-log-out"></span> Logout</a></li>
      </ul>
    </ul>
</nav>
</div>
<br/>

</html>

<div class="container" style="margin-top:35px;">
  <h4>Select Records to Show:</h4>
  <div class="form-group">
    <select name="state" id="maxRows" class="form-control" style="width: 150px;">
    <option value="5000">All</option>	
    <option value="5">5</option>	
    <option value="10">10</option>	
    <option value="15">15</option>	
    <option value="20">20</option>	
    <option value="50">50</option>	
    <option value="100">100</option>		
    </select>
    </div>		
  <div class="pagination-container">
  <nav>
    <ul class="pagination"></ul>
  </nav>

</div>
  </div>




<script>
var table = '#emptable'
$('#maxRows').on('change', function(){
  $('.pagination').html('')
  var trnum = 0
  var maxRows = parseInt($(this).val())
  var totalRows = $(table+' tbody tr').length
  $(table+' tr:gt(0)').each(function(){
    trnum++
    if(trnum > maxRows){
      $(this).hide()
    }
    if(trnum <= maxRows){
      $(this).show()
    }
  })
  if(totalRows > maxRows){
    var pagenum = Math.ceil(totalRows/maxRows)
    for(var i=1;i<=pagenum;){
      $('.pagination').append('<li data-page="'+i+'">\<span>'+ i++ +'<span class="sr-only">(current)</span></span>\</li>').show()
    }
  }
  $('.pagination li:first-child').addClass('active')
      $('.pagination li').on('click',function(){
      var pagenum = $(this).attr('data-page')
      var trIndex = 0;
        $('.pagination li').removeClass('active')
        $(this).addClass('active')
        $(table+' tr:gt(0)').each(function(){
        trIndex++
        if(trIndex > (maxRows*pagenum) || trIndex <= ((maxRows*pagenum)-maxRows)){
          $(this).hide()
        }else{
          $(this).show()
        }
        })
      })								
})

$(function(){
var id = 0;
  $('table tr:gt(0)').each(function(){
  id++
  $(this).prepend('<td>'+id+'</td>')
  })
})


$(document).ready(function(){  
             $('#search').keyup(function(){  
                  search_table($(this).val());  
             });  
             function search_table(value){  
                  $('#emptable tr').each(function(){  
                       var found = 'false';  
                       $(this).each(function(){  
                            if($(this).text().toLowerCase().indexOf(value.toLowerCase()) >= 0)  
                            {  
                                 found = 'true';  
                            }  
                       });  
                       if(found == 'true')  
                       {  
                            $(this).show();  
                       }  
                       else  
                       {  
                            $(this).hide();  
                       }  
                  });  
             }  
        });

      
</script>
<html>
    <title>View Employee Details</title>
    <body>
      <!-- <center><h1>Employees Record</h1></center> -->
  <input type="text" name="search" id="search" class="form-control" placeholder="Search By Name" />  
    
<table id="emptable" class="responstable" style="width:100%; margin-left:10px; margin-right:50px;" >
 
    <tr  >
    <th  width="5%" name="empname" id="empname">Employee Name</th>
    <th width="5%" name="empemail" id="empemail">Email</th>
    <th width="5%" name="empphone" id="empphone">Phone</th>
    <th width="5%" name="empadd" id="empadd">Address</th>
    <th width="5%" name="empdept" id="empdept">Department</th>
    <th width="5%" name="empbir" id="empbir">Birth Date</th>
    <th width="5%" name="empsal" id="empsal">Salary</th>
    <th width="5%">Action Delete</th>
    <th width="5%">Action Update</th>

  </tr>



 </table>
        
       
     
    <script>
      
      populateTable();
function populateTable(){
       var mydata;
        var userdata;
      $(document).ready(function(){
        console.log('Unable to put data'); 

       
                $.getJSON("http://employeemanagementsystem.herokuapp.com/employee", function(data){
                    console.log(data);
           
                  $.each(data, function(i, field){
                   
                       $('#emptable').append('<tr  ><td>'+field.employeename+'</td><td>'+field.Email+
                        '</td><td>'+field.phone+'</td><td>'+field.address+'</td><td>'+field.department+'</td><td>'+field.dob+'</td><td>'+field.salary+'</td><td><a href="#" id="btn1" class="deleteEmployee btn btn-danger "   rel="' + this._id + '" >delete</a></td><td> <a href=""  class="btn btn-warning" data-toggle="modal" data-target="#myModal" contenteditable="false"  ><span class="glyphicon glyphicon-edit"></span>Update</a></td></tr>' 
            
                    );

               
                        });
                     
        
                        
     
                })
               
            });
          }
  
$('#emptable tbody').on('click', 'td a.deleteEmployee', function deleteEmployee(event){


    event.preventDefault();
    // Pop up a confirmation dialog
    var confirmation = confirm('Are you sure you want to delete this user?');
    // Check and make sure the user confirmed
    if (confirmation === true) {
        // If they did, do our delete
        $.ajax({
            method:'DELETE',
            type: 'DELETE',
            url: '/employee/'  + $(this).attr('rel'),

        }).done(function( response) {
          
           
          
                      // Check for a successful (blank) response
          
                      if (response.msg == '') {
                       
          
                      }
          
                      else {
                     
                        alert('sucessfully deleted!');
                        location.reload();
                        
          
                      }

});
}else {

// If they said no to the confirm, do nothing

        return false;

    }
})

 </script>
            
       <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
            aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                
                    </div>
                </div>
                <div class="modal-dialog">
                    <div class="modal-content"></div>
                </div>
               
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal"> <span aria-hidden="true" class="">Ã—   </span><span class="sr-only">Close</span>
            
                            </button>
                             <h4 class="modal-title" id="myModalLabel">Modal title</h4>
                             <label id="columnHeader" >Employee Name</label>
                             <input type="text" name="mytitle" class="field-style field-split align-left" placeholder="Employeename" size="75" />
                             <br><br>
                             <input type="text" name="mytitle" class="field-style field-split align-left" placeholder="Email" size="75"  />
                             <br><br>
                             <input type="text" name="mytitle" class="field-style field-split align-left" placeholder="Phone" size="75" />
                             <br><br>
                             <input type="text" name="mytitle" class="field-style field-split align-left" placeholder="Address" size="75" />
                             <br><br>
                             <input type="text" name="mytitle" class="field-style field-split align-left" placeholder="Department" size="75"  />
                             <br><br>
                             <input type="text" name="mytitle" class="field-style field-split align-left" placeholder="Birth Date" size="75"  />
                             <br><br>
                             <input type="text" name="mytitle" class="field-style field-split align-left" placeholder="Salary" size="75" />



                        </div>
                        <div class="modal-body"></div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
              




              <script>
                // sandbox disable popups
                if (window.self !== window.top && window.name!="view1") {;
                  window.alert = function(){/*disable alert*/};
                  window.confirm = function(){/*disable confirm*/};
                  window.prompt = function(){/*disable prompt*/};
                  window.open = function(){/*disable open*/};
                }
                
                // prevent href=# click jump
                document.addEventListener("DOMContentLoaded", function() {
                  var links = document.getElementsByTagName("A");
                  for(var i=0; i < links.length; i++) {
                    if(links[i].href.indexOf('#')!=-1) {
                      links[i].addEventListener("click", function(e) {
                      console.debug("prevent href=# click");
                          if (this.hash) {
                            if (this.hash=="#") {
                              e.preventDefault();
                              return false;
                            }
                            else {
                              /*
                              var el = document.getElementById(this.hash.replace(/#/, ""));
                              if (el) {
                                el.scrollIntoView(true);
                              }
                              */
                            }
                          }
                          return false;
                      })
                    }
                  }
                }, false);
              </script>
              
              <!--scripts loaded here-->
              
              <script src="//ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
              <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
              
              
              
              <script>
              $(".btn[data-target='#myModal']").click(function() {
                   var columnHeadings = $("thead th").map(function() {
                             return $(this).text();
                          }).get();
                   columnHeadings.pop();
                   var columnValues = $(this).parent().siblings().map(function() {
                             return $(this).text();
                   }).get();
              var modalBody = $('<div id="modalContent"></div>');
              var modalForm = $('<form role="form" name="modalForm" action="putYourPHPActionHere.php" method="post"></form>');
              $.each(columnHeadings, function(i, columnHeader) {
                   var formGroup = $('<div class="form-group"></div>');
                   formGroup.append('<label for="'+columnHeader+'">'+columnHeader+'</label>');
                   formGroup.append('<input class="form-control" empname="'+columnHeader+i+'" id="'+columnHeader+i+'" value="'+columnValues[i]+'" />'); 
                   modalForm.append(formGroup);
              });
              modalBody.append(modalForm);
              $('.modal-body').html(modalBody);
            });
            $('.modal-footer .btn-primary').click(function() {
               $('form[name="modalForm"]').submit();
            });



            function showRow(row,url)
          {
          var x=row.cells;
          document.getElementById("empname").value = x[1].innerHTML;
          document.getElementById("empemail").value = x[2].innerHTML;
          document.getElementById("empphone").value = x[3].innerHTML;
          document.getElementById("empadd").value = x[4].innerHTML;
          document.getElementById("empdept").value = x[5].innerHTML;
          document.getElementById("empbir").value = x[6].innerHTML;
          document.getElementById("empsal").value = x[7].innerHTML;
            modal.style.display = "block";
          }


              </script>
            


    </body>
</html>